// map+双向链表
class LRUCache {
    private Map<Integer, Node> map;
    private Node first;
    private Node last;
    private int size;
    private int curSize;

    public LRUCache(int capacity) {
        // 初始化变量
        this.map = new HashMap<>(capacity);
        this.first = new Node();
        this.last = new Node();
        this.size = capacity;
        // 头尾相连
        this.first.next = last;
        this.last.pre = first;
        curSize = 0;
    }

    public int get(int key) {
        Node node = this.map.get(key);
        if(node == null) return -1;
        // 移除该节点
        removeNode(node);
        // 将该节点移至头部
        addNodeToFirst(node);
        return node.value;
    }

    public void put(int key, int value) {
        Node node = this.map.get(key);
        if(node == null){
            // 不存在
            // 判断是否超出内存，超出则清除
            if(this.map.size() >= this.size){
                this.map.remove(this.last.pre.key);
                removeNode(this.last.pre);
            }
            node = new Node(key,value);
            this.map.put(key,node);
        }
        else{
            // 存在，更新值
            node.value = value;
            // 删除
            removeNode(node);
        }
        // 添加到头部
        addNodeToFirst(node);
    }

    // 移除节点
    private void removeNode(Node node){
        node.next.pre = node.pre;
        node.pre.next = node.next;
    }

    // 添加节点到头部
    private void addNodeToFirst(Node node){
        Node tmp = this.first.next;
        this.first.next = node;
        node.pre = this.first;
        node.next = tmp;
        tmp.pre = node;
        this.curSize++;
    }
}

public class Node{
    public int key;
    public int value;
    public Node next;
    public Node pre;
    public Node() {};
    public Node(int key,int value){
        this.key = key;
        this.value = value;
    }
}

/**
 * Your LRUCache object will be instantiated and called as such:
 * LRUCache obj = new LRUCache(capacity);
 * int param_1 = obj.get(key);
 * obj.put(key,value);
 */